{"version":3,"sources":["../src/form_ctrl.js"],"names":["saveForm","data","timestamp","ctrl","isReadyToWriteInData","utils","alert","equipment","filter","d","name","value","category","comment","length","reasons","includes","reduce","arr","r","push","reason","join","parentReason","line","writeInfluxLine","url","influxHost","post","then","$","trigger","refreshPanel","catch","console","log","e","measurement","getQueryMeasurement","rowData","Site","Area","Line","stopped","idle","execute","held","complete","status","duration","undefined","showForm","reason_code_endp","getReasonCodeEndPoint","influxUrl","postgresUrl","postgRestHost","get","handleData","equipmentRes","res","categoryRes","popUpOptionModal","removeOptionListeners","addOptionListeners","appEvents","emit","src","modalClass","model","document","off","on","target","id","popUpModal","removeListeners","addListeners","processedData","processData","removeRequestListeners","addRequestListeners","text","val","requestComment","camApi","postMsg","rowdata","time","moment","format","area","site","split","eventComment","retryTimes","showCate","setTimeout","showCategories","categories","cat","category_id","reason_id","parent_reason_id","categoriesGroup","forEach","append","renderCategory","c","insertBefore","inArray","slider","min","max","enableInstantSearch","showEmptyMsg","group","influxRes","results","series","cols","columns","vals","values","o","row","i","nextData","equipmentEndp","getEquipmentEndPoint","equipmentUrl","input_container","input","radio_tile_group","label","showReasons","isFirstLevel","level","upperReasonsGroup","currentCategorySelected","parseInt","parentElement","rea","reasonsGroup","separator","title","renderReason","insertAfter","appendTarget","checkSelectedReasons","config_reasons","selectedReasons","remove","reasonGroup","removeNext","nextElementSibling","serializeArray","checkEquipment","showSplitForm","isEquipmentValid","equip","production_line","indexOf","next","className"],"mappings":"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","file":"form_ctrl.js","sourcesContent":["import { appEvents } from 'app/core/core'\nimport { showSplitForm } from './split_event_form'\nimport * as utils from './utils'\nimport * as camApi from './camundaAPI'\nimport moment from 'moment'\nimport { enableInstantSearch } from './instant_search_ctrl'\nimport slider from './libs/bootstrap-slider'\nimport { refreshPanel } from './table_ctrl'\nimport * as ctrl from './table_ctrl'\n\nlet categoryRes\nlet equipmentRes\nlet rowData = {}\nlet nextData;\nlet currentCategorySelected\n\nfunction saveForm (data, timestamp) {\n\n  if (!ctrl.isReadyToWriteInData()) {\n    utils.alert('error', 'Error', \"The measurement you put in the Down Time Panel may be invalid, please make sure it matches the one that's in the query\")\n    return\n  }\n  \n  const equipment = data.filter(d => d.name === 'equipment')[0].value\n\n  const category = data.filter(d => d.name === 'category')\n  \n  const comment = data.filter(d => d.name === 'comment')[0].value\n  \n  if (!category.length > 0) {\n    utils.alert('warning', 'Warning', 'Please select a category')\n    return\n  }\n  let reasons = data.filter(d => d.name.includes('reasons-'))\n  reasons = reasons.reduce((arr, r) => {\n    arr.push(r.value)\n    return arr\n  }, [])\n  const reason = reasons.join(' | ')\n  const parentReason = reasons[0]\n\n  const line = writeInfluxLine(category[0].value, parentReason, reason, comment, timestamp, equipment)\n//   console.log(line);\n  \n  let url = utils.influxHost + 'write?db=smart_factory'\n  utils.post(url, line)\n    .then(res => {\n    //   console.log(res)\n      //save success. close the form\n      $('#event-editor-form-cancelBtn').trigger('click')\n      utils.alert('success', 'Success', 'form saved')\n      refreshPanel()\n    })\n    .catch(e => {\n      console.log(e)\n      utils.alert('error', 'Error', `Unexpected error occurred whiling saving the form due to '${e}', please try again`)\n    })\n}\n\n/**\n * Write query line to update the selected record influxdb\n */\nfunction writeInfluxLine (category, parentReason, reason, comment, timestamp, equipment) {\n  const measurement = ctrl.getQueryMeasurement()\n  let line = measurement + ',Site=' + rowData.Site + ',Area=' + rowData.Area + ',Line=' + rowData.Line + ' '\n\n  line += 'stopped=' + rowData.stopped + ','\n  line += 'idle=' + rowData.idle + ','\n  line += 'execute=' + rowData.execute + ','\n  line += 'held=' + rowData.held + ','\n  line += 'complete=' + rowData.complete + ','\n  line += 'status=\"' + rowData.status + '\"' + ','\n\n  if (rowData.duration !== null && rowData.duration !== undefined) {\n    line += 'duration=\"' + rowData.duration + '\"' + ','\n  }\n  if (comment !== '' && comment !== undefined) {\n    line += 'comment=\"' + comment + '\"' + ','\n  }\n  if (equipment !== '' && equipment !== undefined) {\n    line += 'equipment=\"' + equipment + '\"' + ','\n  }\n  line += 'parentReason=\"' + parentReason + '\"' + ','\n  line += 'category=\"' + category + '\"' + ','\n  line += 'reason=\"' + reason + '\"' + ' '\n  line += timestamp\n\n//   console.log(line);\n  return line\n}\n\n/**\n * Send query req to influxdb and postgresql in order to show form contents.\n */\nexport function showForm (timestamp) {\n  //console.log(timestamp)\n  const measurement = ctrl.getQueryMeasurement()\n  const reason_code_endp = ctrl.getReasonCodeEndPoint()\n  let influxUrl = utils.influxHost + `query?pretty=true&db=smart_factory&q=select * from ${measurement} where time >= ${timestamp} limit 2`\n  let postgresUrl = utils.postgRestHost + reason_code_endp\n\n  // send query requests\n  utils.get(influxUrl)\n    .then(handleData)\n    .then(url =>\n      utils.get(url)\n        .then(res => {\n          equipmentRes = res\n        }).then(utils.get(postgresUrl)\n            .then(res => {\n                categoryRes = res\n                popUpOptionModal(timestamp)\n            }).catch(e => {\n              utils.alert('error', 'Error', `Cannot find any reason codes with ${reason_code_endp}, please double check the table name`)\n              console.log(e)\n            })\n          ).catch(e => {\n            utils.alert('error', 'Error', 'Unexpected error occurred whiling getting data from database, please try again')\n            console.log(e)\n            return\n          })\n        .catch(e => {\n          utils.alert('error', 'Error', 'Unexpected error occurred whiling getting data from database, please try again')\n          console.log(e)\n          return\n        })\n    )\n    .catch(e => {\n      utils.alert('error', 'Error', 'Unexpected error occurred whiling getting data from database, please try again')\n      console.log(e)\n      return\n    })\n\n  // remove all listeners\n  removeOptionListeners()\n  // add listeners\n  addOptionListeners(timestamp)\n}\n\nfunction popUpOptionModal () {\n  appEvents.emit('show-modal', {\n    src: 'public/plugins/smart-factory-event-editor-table-panel/partials/popup_options_form.html',\n    modalClass: 'editOrMaintenance-modal',\n    model: {}\n  })\n}\n\nfunction removeOptionListeners() {\n  $(document).off('click', 'input[type=\"radio\"][name=\"edit-maintain-radio\"]')\n}\n\nfunction addOptionListeners(timestamp) {\n\n  $(document).on('click', 'input[type=\"radio\"][name=\"edit-maintain-radio\"]', e => {\n    \n    if (e.target.id === 'edit') {\n      //popup editor\n      popUpModal(timestamp)\n      // remove all listeners\n      removeListeners()\n      // add listeners\n      addListeners(timestamp)\n    }else if (e.target.id === 'maintain') {\n      //if no data, tell the user and open up the editor\n      if (!rowData.category) {\n        utils.alert('warning', 'Reason Codes Not Found', 'Please specify reason codes for this event before requesting maintenance')\n        //popup editor\n        popUpModal(timestamp)\n        // remove all listeners\n        removeListeners()\n        // add listeners\n        addListeners(timestamp)\n      }else {\n        //if there is data\n        const processedData = processData(rowData)\n        appEvents.emit('show-modal', {\n          src: 'public/plugins/smart-factory-event-editor-table-panel/partials/maintenanceRequestComment.html',\n          modalClass: 'confirm-modal',\n          model: {}\n        })\n        // remove all listeners\n        removeRequestListeners()\n        // add listeners\n        addRequestListeners(processedData)\n      }\n    }\n  })\n}\n\nfunction removeRequestListeners() {\n  $(document).off('click', 'button#event-editor-form-maintenance-request-sendBtn')\n}\n\nfunction addRequestListeners(processedData) {\n  $(document).on('click', 'button#event-editor-form-maintenance-request-sendBtn', function (){\n    const text = $('#edit-maintenance-request-text').val()\n    processedData.requestComment = text\n    camApi.postMsg(processedData)\n    $('#edit-maintenance-request-comment-close-btn').trigger('click')\n  })\n}\n\nfunction processData (rowdata) {\n  const time = moment(rowdata.time).format('YYYY-MM-DD HH:mm:ss')\n  const equipment = rowdata.equipment || \"Unknown | Unknown\"\n  const reason = rowdata.reason || \"Unknown\"\n  const comment = rowdata.comment || \"\"\n\n  return {\n    area: rowdata.Area,\n    site: rowdata.Site,\n    line: rowdata.Line,\n    category: rowdata.category,\n    duration: rowdata.duration.split('.')[0],\n    equipment: equipment.split(' | ')[1],\n    reason: reason,\n    status: rowdata.status,\n    eventComment: comment,\n    time: time\n  }\n}\n\n/**\n * Popup the event editor form modal and pass the timestamp into the html as for the form_id\n * and then show categories\n */\nlet retryTimes = 1\nfunction popUpModal (timestamp) {\n  appEvents.emit('show-modal', {\n    src: 'public/plugins/smart-factory-event-editor-table-panel/partials/event_editor_form.html',\n    modalClass: 'confirm-modal event-editor-form-modal scroll',\n    model: { timestamp: timestamp }\n  })\n\n  // set timeout to make sure the DOM exist in order to append categories\n  retryTimes = 1\n  showCate()\n}\n\nfunction showCate(){\n  setTimeout(() => {\n    try{\n      showCategories()\n    }catch (e) {\n      console.log(e);\n      if (retryTimes > 15) {\n        $('#event-editor-form-cancelBtn').trigger('click')\n        utils.alert('error', 'Error', 'Editor Form init failed due to the form trying to initialise and at the same time the page being refreshing, please try agian')\n      }else {\n        // console.log('Editor Form init failed due to the page being refreshing, re-initialising...the ' + retryTimes + 'th time');\n        showCate()\n        retryTimes ++\n      }\n    }\n  }, 200);\n}\n\n/**\n * As the modal is popped up, meaning that the html DOM is now existing. Show content dynamically based on categoryRes\n * And then add\n */\nfunction showCategories () {\n  // category is the top level, there shouldn't be reason_id and parent_reason_id\n  let categories = categoryRes.filter(\n    cat =>\n      cat.category_id !== null &&\n      cat.reason_id === null &&\n      cat.parent_reason_id === null\n  )\n  categories = categories.reduce((arr, cat) => {\n    arr.push(cat.category_id)\n    return arr\n  }, [])\n  let categoriesGroup = $('<div class=\"radio-tile-group\"></div>')\n  categories.forEach(c => {\n    categoriesGroup.append(renderCategory(c))\n  })\n  let target = $('div.target-being-below-categories')\n  categoriesGroup.insertBefore(target)\n  //console.log(categories)\n\n  // check if category already exist, if yes, select it\n  if (rowData.category !== null) {\n    // check if category in categories arr\n    if ($.inArray(rowData.category, categories) !== -1) {\n      // inArray function returns -1 if false, !== -1 means it exists\n      $('input[type=radio][name=category][value=' + '\"' + rowData.category + '\"' + ']').trigger('click')\n    }\n  }\n\n  //display comment if there is\n  if (rowData.comment !== null && rowData.comment !== undefined && rowData.comment !== '') {\n    $('#editor-form-comment-area').text(rowData.comment)\n  }\n\n  //just for testing if the form can start successfully, \n  //if not, the slider.on will thorw err, then will catch it to restart the form\n  let slider = $('#event-split-slider1').slider({\n    min: 1,\n    max: 20,\n    value: 18,\n  })\n  slider.on('change', obj => {\n  })\n\n  if (rowData.equipment !== \"\" && rowData.equipment !== null && rowData.equipment !== undefined) {\n    $('input#eet-datalist-input-equipment').val(rowData.equipment)\n  }\n\n  //init the datalist for equipment\n  enableInstantSearch(equipmentRes)\n\n  if (categoryRes.length === 0) {\n    showEmptyMsg()\n  }\n}\n\nfunction showEmptyMsg(){\n  $('div#category-div-id').text('')\n  let group = $('<p>No reason codes were found, you can add reason codes from the <strong>Reason Codes Tree Panel</strong></p>')\n  let target = $('div.target-being-below-categories')\n  group.insertBefore(target)\n}\n\n/**\n * Make the response row data from the influxdb into one single object for better use\n * Then use the site, area and line attr from the rowData as the keys to get make up a query url then retrun it\n */\nfunction handleData (res) {\n  let influxRes = res.results[0].series[0]\n  let cols = influxRes.columns\n  let vals = influxRes.values\n  let data = []\n  for (let o = 0; o < vals.length; o++) {\n    let row = {}\n    for (let i = 0; i < cols.length; i++) {\n      row[cols[i]] = vals[o][i]\n    }\n    data.push(row)\n  }\n  rowData = data[0]\n  nextData = data.length === 2 ? data[1] : {}\n  // console.log('next record is empty ? --> ' + $.isEmptyObject(nextData))\n  const equipmentEndp = ctrl.getEquipmentEndPoint()\n  let equipmentUrl = utils.postgRestHost + `${equipmentEndp}?production_line=eq.${rowData.Line}&equipment=not.is.null`\n  return equipmentUrl\n}\n\n/**\n * Make up a single category box with the category passed in, and then return the box.\n */\nfunction renderCategory (category) {\n  let input_container = $('<div class=\"input-container categories-input-container\">')\n  let input = $('<input id=\"' + category + '\" class=\"radio-button\" type=\"radio\" name=\"category\" value=\"' + category + '\" />')\n  let radio_tile_group = $('<div class=\"radio-tile\"></div>')\n  let label = $('<label for=\"' + category + '\" class=\"radio-tile-label\">' + category + '</label>')\n\n  radio_tile_group.append(label)\n  input_container.append(input).append(radio_tile_group)\n\n  return input_container\n}\n\n/**\n * Show the reasons\n * and then append to the DOM\n * NOTE: if is first, target var passed in is a string. else, target passed in is an object\n */\nfunction showReasons (target, isFirstLevel) {\n  let reasons\n  let level\n  let upperReasonsGroup\n\n  if (isFirstLevel) {\n    // is the first level\n    // category = target, reasonid !== null and parentid === null\n    reasons = categoryRes.filter(\n      cat =>\n        cat.category_id === target &&\n        cat.reason_id !== null &&\n        cat.parent_reason_id === null\n    )\n    level = 1\n  } else {\n    // is lower level\n    // category = global_currentCategorySelected, reasonsid !== null and parentid === target.value\n    reasons = categoryRes.filter(\n      cat =>\n        cat.category_id === currentCategorySelected &&\n        cat.reason_id !== null &&\n        cat.parent_reason_id === target.value\n    )\n    // level +1 based on the upper one\n    level = parseInt(target.name.split('-')[1]) + 1\n    upperReasonsGroup = target.parentElement.parentElement\n  }\n\n  reasons = reasons.reduce((arr, rea) => {\n    arr.push(rea.reason_id)\n    return arr\n  }, [])\n  //console.log(reasons)\n\n  if (reasons.length === 0) return\n\n  let reasonsGroup = $('<div class=\"switch-field\"></div>')\n\n  if (level !== 1) {\n    let separator = $('<div class=\"custom-separator\"></div>')\n    reasonsGroup.append(separator)\n  }\n\n  let title = $('<div class=\"switch-title\">Reason Level ' + level + '</div>')\n  reasonsGroup.append(title)\n\n  reasons.forEach(r => {\n    reasonsGroup.append(renderReason(r, level))\n  })\n\n  if (level !== 1) {\n    reasonsGroup.insertAfter(upperReasonsGroup)\n  } else {\n    let appendTarget = $('div.target-being-above-reason-level-1')\n    reasonsGroup.insertAfter(appendTarget)\n  }\n\n  checkSelectedReasons(level, reasons)\n}\n\n/**\n * Check if there is reasons that are already selected for each level\n * If there is seleceted reason and for that level, it can be found in the config reason arr, then trigger click\n */\nfunction checkSelectedReasons (level, config_reasons) {\n  // make sure the current selected category is the same with the recorded category to avoid unwanted results\n  if (currentCategorySelected === rowData.category) {\n    if (rowData.reason !== null) {\n      let selectedReasons = rowData.reason.split(' | ')\n      if (selectedReasons[level - 1] !== null) {\n        if ($.inArray(selectedReasons[level - 1], config_reasons) !== -1) {\n          $(`input[type=radio][name*='reasons-'][value=` + '\"' + selectedReasons[level - 1] + '\"' + `]`).trigger('click')\n        }\n      }\n    }\n  }\n}\n\n/**\n * Make up a single reason option with the reason passed in, and then return the option.\n */\nfunction renderReason (reason, level) {\n  let id = level + '-' + reason\n  let group = $('<div></div>')\n  let input = $('<input type=\"radio\" id=\"' + id + '\" name=\"reasons-' + level + '\" value=\"' + reason + '\"/>')\n  let label = $('<label for=\"' + id + '\">' + reason + '</label>')\n  group.append(input).append(label)\n  return group\n}\n\n/**\n * Add listener for categories and reasons\n */\nfunction addListeners (timestamp) {\n  // categories on selected, find reasons where cate_id = this.value && parent_id === null\n  $(document).on('change', 'input[type=radio][name=category]', e => {\n    // console.log(e.target.value)\n    currentCategorySelected = e.target.value\n    // must remove all reasons before show reasons\n    $('div.switch-field').remove()\n    showReasons(e.target.value, true)\n  })\n\n  $(document).on('change', \"input[type=radio][name*='reasons-']\", e => {\n    // console.log(e.target.value);\n\n    // before show reasons, must remove all reason levels that are below this target reason level\n    let reasonGroup = e.target.parentElement.parentElement\n    // Remove reason level one level by one level until it return false.\n    while (removeNext(reasonGroup.nextElementSibling)) {}\n\n    showReasons(e.target, false)\n  })\n\n  $(document).on('click', 'button#event-editor-form-saveBtn', function (){\n    let data = $('form#'+timestamp).serializeArray()\n    if (!checkEquipment(data)){ return }\n    saveForm(data, timestamp);\n  })\n\n  $(document).on('click', 'button#event-editor-form-splitBtn', function (){\n    let data = $('form#'+timestamp).serializeArray()\n    if (!checkEquipment(data)){ return }\n    $('.event-split-form-modal').remove()\n    showSplitForm(data, rowData, nextData)\n  })\n}\n\nfunction checkEquipment(data) {\n  const equipment = data.filter(d => d.name === 'equipment')[0].value\n    //check for equipment input\n\n  if (!isEquipmentValid(equipment)) { \n    //equipment can be empty but if it's not empty it must be the same with the original one to ensure consistency\n    if (equipment !== \"\") { \n      utils.alert('warning', 'Warning', 'Equipment not found, please select it from the list or leave it empty')\n      return false\n    }\n  }\n\n  return true\n}\n\nfunction isEquipmentValid(equipment) {\n  \n  const equip = equipmentRes.reduce((arr, e) => {\n    const text = e.production_line + ' | ' + e.equipment    \n    arr.push(text)\n    return arr\n  }, [])\n  if (equip.indexOf(equipment) === -1) {\n    return false\n  }\n  return true\n}\n\nfunction removeListeners () {\n  $(document).off('change', 'input[type=radio][name=category]')\n  $(document).off('change', \"input[type=radio][name*='reasons-']\")\n  $(document).off('click', 'button#event-editor-form-saveBtn')\n  $(document).off('click', 'button#event-editor-form-splitBtn')\n}\n\n/**\n * Remove Div named 'switch-field', which is one level of reasons\n */\nfunction removeNext (next) {\n  if (next.className === 'switch-field') {\n    next.remove()\n    return true\n  } else {\n    return false\n  }\n}"]}